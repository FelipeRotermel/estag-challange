/* A */
 
SELECT PRODUCT.NMPRODUCT, COUNT(PRODUCTREQUEST.CDREQUEST) AS QTSOLD
FROM PRODUCTREQUEST
INNER JOIN PRODUCT ON PRODUCTREQUEST.CDPRODUCT = PRODUCT.CDPRODUCT
GROUP BY PRODUCT.NMPRODUCT;

/* B */

SELECT SUPPLIER.NMSUPPLIER, COUNT(PRODUCT.CDSUPPLIER) AS QTITEMSSUP
FROM PRODUCT
INNER JOIN SUPPLIER ON PRODUCT.CDSUPPLIER = SUPPLIER.CDSUPPLIER
GROUP BY SUPPLIER.NMSUPPLIER;

/* C */

SELECT SUPPLIER.NMSUPPLIER, PRODUCT.NMPRODUCT, SUM(PRODUCTREQUEST.QTAMOUNT) AS QTSOLD
FROM PRODUCTREQUEST
INNER JOIN PRODUCT ON PRODUCTREQUEST.CDPRODUCT = PRODUCT.CDPRODUCT
INNER JOIN SUPPLIER ON PRODUCT.CDSUPPLIER = SUPPLIER.CDSUPPLIER
GROUP BY ROLLUP (SUPPLIER.NMSUPPLIER, PRODUCT.NMPRODUCT);

/* D */

SELECT CUSTOMER.NMCUSTOMER, PRODUCT.NMPRODUCT, SUM(PRODUCTREQUEST.VLUNITARY * PRODUCTREQUEST.QTAMOUNT) AS QTBUY
FROM PRODUCTREQUEST
INNER JOIN PRODUCT ON PRODUCTREQUEST.CDPRODUCT = PRODUCT.CDPRODUCT
INNER JOIN REQUEST ON PRODUCTREQUEST.CDREQUEST = REQUEST.CDREQUEST
INNER JOIN CUSTOMER ON REQUEST.CDCUSTOMER = CUSTOMER.CDCUSTOMER
GROUP BY ROLLUP (CUSTOMER.NMCUSTOMER, PRODUCT.NMPRODUCT);

/* E */

SELECT CUSTOMER.NMCUSTOMER, CUSTOMER.IDFONE
FROM REQUEST
INNER JOIN CUSTOMER ON REQUEST.CDCUSTOMER = CUSTOMER.CDCUSTOMER
GROUP BY  CUSTOMER.NMCUSTOMER, CUSTOMER.IDFONE
HAVING COUNT(CDREQUEST) < 1;

/* F */

SELECT SUPPLIER.NMSUPPLIER, SUPPLIER.IDFONE
FROM PRODUCT
INNER JOIN SUPPLIER ON PRODUCT.CDSUPPLIER = SUPPLIER.CDSUPPLIER
WHERE PRODUCT.NMPRODUCT = 'leite em po' OR PRODUCT.NMPRODUCT = 'agua mineral';

/* G */

SELECT PRODUCT.NMPRODUCT, SUPPLIER.NMSUPPLIER
FROM PRODUCTREQUEST
INNER JOIN PRODUCT ON PRODUCTREQUEST.CDPRODUCT = PRODUCT.CDPRODUCT
INNER JOIN SUPPLIER ON PRODUCT.CDPRODUCT = SUPPLIER.CDSUPPLIER
GROUP BY PRODUCT.NMPRODUCT, SUPPLIER.NMSUPPLIER
HAVING COUNT(PRODUCTREQUEST.CDREQUEST) > 3;