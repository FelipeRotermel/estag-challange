/* A */

SELECT PRODUCT.NMPRODUCT, COUNT(*) AS NUMBEROFPRODUCTS
FROM PRODUCTREQUEST
INNER JOIN PRODUCT ON PRODUCTREQUEST.CDPRODUCT = PRODUCT.CDPRODUCT
GROUP BY PRODUCT.NMPRODUCT;

SELECT DISTINCT PRODUCT.NMPRODUCT
FROM PRODUCTREQUEST
INNER JOIN PRODUCT ON PRODUCTREQUEST.CDPRODUCT = PRODUCT.CDPRODUCT;

/* B */

SELECT PRODUCT.NMPRODUCT, COUNT(PRODUCT.NMPRODUCT) AS COUNTPRODUCT, (PRODUCTREQUEST.QTAMOUNT * COUNT(PRODUCT.NMPRODUCT)) AS QTDTOTAL
FROM PRODUCTREQUEST
INNER JOIN PRODUCT ON PRODUCTREQUEST.CDPRODUCT = PRODUCT.CDPRODUCT
GROUP BY PRODUCT.NMPRODUCT, PRODUCTREQUEST.QTAMOUNT;

/* C */

SELECT SUPPLIER.NMSUPPLIER, SUM(QTSTOCK) AS TOTALSTOCK, (SUM(PRODUCT.VLPRICE) / COUNT(QTSTOCK)) AS AVGVALUE, COUNT(SUPPLIER.NMSUPPLIER) AS QTPRODUCTS
FROM PRODUCT
INNER JOIN SUPPLIER ON PRODUCT.CDSUPPLIER = SUPPLIER.CDSUPPLIER
GROUP BY SUPPLIER.NMSUPPLIER;

/* D */

SELECT CUSTOMER.NMCUSTOMER, CUSTOMER.IDFONE, MAX(REQUEST.VLTOTAL) AS VLMAX, MIN(REQUEST.VLTOTAL) AS VLMIN, SUM(REQUEST.VLTOTAL) AS VLTOTAL, AVG(REQUEST.VLTOTAL) AS VLMED
FROM REQUEST
INNER JOIN CUSTOMER ON REQUEST.CDCUSTOMER = CUSTOMER.CDCUSTOMER
GROUP BY CUSTOMER.NMCUSTOMER, CUSTOMER.IDFONE
ORDER BY MAX(REQUEST.VLTOTAL);

/* E */

SELECT REQUEST.DTREQUEST, CUSTOMER.NMCUSTOMER, COUNT(PRODUCTREQUEST.CDPRODUCT) AS DISTINCTPRODUCTS,
SUM(PRODUCTREQUEST.VLUNITARY * PRODUCTREQUEST.QTAMOUNT) AS REQUESTVALUE,
AVG(PRODUCTREQUEST.VLUNITARY) AS AVGREQUESTVALUE
FROM REQUEST
INNER JOIN PRODUCTREQUEST ON REQUEST.CDREQUEST = PRODUCTREQUEST.CDREQUEST
INNER JOIN CUSTOMER ON REQUEST.CDCUSTOMER = CUSTOMER.CDCUSTOMER
GROUP BY CUSTOMER.NMCUSTOMER, REQUEST.DTREQUEST ORDER BY COUNT(PRODUCTREQUEST.CDPRODUCT);

/* F */

SELECT SUPPLIER.NMSUPPLIER, COUNT(SUPPLIER.NMSUPPLIER)
FROM PRODUCT
INNER JOIN SUPPLIER ON PRODUCT.CDSUPPLIER = SUPPLIER.CDSUPPLIER
GROUP BY SUPPLIER.NMSUPPLIER
HAVING COUNT(SUPPLIER.NMSUPPLIER) > 1;

/* G */

SELECT PRODUCT.NMPRODUCT, COUNT(PRODUCTREQUEST.CDPRODUCT),
CASE
	WHEN COUNT(PRODUCTREQUEST.CDPRODUCT) <= 2
	THEN SUM(PRODUCTREQUEST.QTAMOUNT)
	END AS QTTWOAMOUNT
FROM PRODUCTREQUEST
INNER JOIN PRODUCT ON PRODUCTREQUEST.CDPRODUCT = PRODUCT.CDPRODUCT
GROUP BY PRODUCT.NMPRODUCT;

/* H */

SELECT CUSTOMER.NMCUSTOMER, PRODUCT.NMPRODUCT, (PRODUCTREQUEST.VLUNITARY * PRODUCTREQUEST.QTAMOUNT ), COUNT(PRODUCTREQUEST.CDPRODUCT), SUPPLIER.NMSUPPLIER
FROM PRODUCTREQUEST
INNER JOIN CUSTOMER ON PRODUCTREQUEST.CDREQUEST = CUSTOMER.CDCUSTOMER
INNER JOIN PRODUCT ON PRODUCTREQUEST.CDPRODUCT = PRODUCT.CDPRODUCT
INNER JOIN SUPPLIER ON PRODUCTREQUEST.CDPRODUCT = SUPPLIER.CDSUPPLIER
GROUP BY CUSTOMER.NMCUSTOMER, PRODUCT.NMPRODUCT, (PRODUCTREQUEST.VLUNITARY * PRODUCTREQUEST.QTAMOUNT), SUPPLIER.NMSUPPLIER
HAVING (PRODUCTREQUEST.VLUNITARY * PRODUCTREQUEST.QTAMOUNT ) > 1000
ORDER BY CUSTOMER.NMCUSTOMER, PRODUCT.NMPRODUCT;
